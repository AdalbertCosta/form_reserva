<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solicitação de Demandas - Reserva Universitário </title>
  <meta name="description" content="Envie sua solicitação de demandas para o condomínio de forma rápida e organizada.">

  <link rel="icon" href="./favicon.svg" type="image/svg+xml">
  <link rel="preload" href="./css/style.min.css" as="style">
  <link rel="stylesheet" href="./css/style.min.css">
  <link rel="stylesheet" href="./css/formulario.css">
  <script>document.documentElement.classList.add('js');</script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@1,900&family=Poppins:wght@400;600&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

  <style>
    html { scroll-behavior: smooth; }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header class="header-bg">
    <div class="header container">
      <a href="index.html">
        <img src="./img/bikcraft.svg" width="136" height="32" alt="Conectta">
      </a>
      <nav aria-label="primaria">
        <ul class="header-menu font-1-m cor-0">
          <li><a href="index.html">Página Inicial</a></li>
          
        </ul>
      </nav>
    </div>
  </header>

  <!-- FORMULÁRIO DE DEMANDAS -->
  <main>
    <section id="demandas">
      <div class="titulo-bg">
        <div class="titulo container">
          <p class="font-2-l-b cor-5">Formulário de Solicitação</p>
          <h1 class="font-1-xxl cor-0">Envie sua Demanda<span class="cor-p1">.</span></h1>
        </div>
      </div>

      <form id="demandasForm" class="orcamento container">
        <div class="orcamento-produto">
          <h2 class="font-1-xs cor-5">Horário de análise das demandas: 17h45 às 19h00 (Seg a Sex)</h2>
        </div>

        <div class="orcamento-dados form">
          <h2 class="font-1-xs cor-9 col-2">Dados do Solicitante</h2>

          <div><label for="nome">Nome *</label><input type="text" id="nome" name="nome" required></div>
          <div><label for="numero_casa">Número da Casa *</label><input type="text" id="numero_casa" name="numero_casa" required></div>
          <div class="col-2"><label for="whatsapp">WhatsApp</label><input type="text" id="whatsapp" name="whatsapp" placeholder="(51) 99999-9999"></div>
          <div class="col-2"><label for="email">E-mail</label><input type="email" id="email" name="email"></div>

          <h2 class="font-1-xs cor-9 col-2">Perfil</h2>
          <div class="col-2">
            <label for="tipo_pessoa">Você é:</label>
            <select id="tipo_pessoa" name="tipo_pessoa" required>
              <option value="">Selecione</option>
              <option value="Proprietário">Proprietário</option>
              <option value="Inquilino">Inquilino</option>
            </select>
          </div>

          <h2 class="font-1-xs cor-9 col-2">Tipo de Solicitação</h2>
          <div class="col-2">
            <select id="tipo_solicitacao" name="tipo_solicitacao" required>
              <option value="">Selecione</option>
              <option value="Solicitação de Reparos/Serviços">Solicitação de Reparos/Serviços</option>
              <option value="Informe/Reclamação">Informe/Reclamação</option>
              <option value="Agendamento Salão de Festas">Agendamento Salão de Festas</option>
              <option value="Sugestão de Melhoria">Sugestão de Melhoria</option>
              <option value="Pedido de Informação">Pedido de Informação</option>
            </select>
          </div>

          <div class="col-2">
            <label for="descricao">Descrição da Solicitação *</label>
            <textarea id="descricao" name="descricao" rows="6" required></textarea>
          </div>

          <button type="submit" class="botao col-2">Enviar Solicitação</button>
        </div>
      </form>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="footer-bg">
    <div class="footer container">
      <img src="./img/bikcraft.svg" alt="Conectta">
      <div class="footer-contato">
        <h3 class="font-2-l-b cor-0">Contato</h3>
        <ul class="font-2-m cor-5">
          <li><a href="https://wa.me/5551982712025" target="_blank">+55 51 98271-2025</a></li>
          <li><a href="mailto:condreserva771@gmail.com">condreserva771@gmail.com</a></li>
          <li>Rua Pedro Petry, 771 - Universitário</li>
          <li>Lajeado - RS</li>
        </ul>
      </div>
      <div class="footer-informacoes">
        <h3 class="font-2-l-b cor-0">Informações</h3>
        <nav>
          <ul class="font-1-m cor-5">
            <li><a href="index.html">Página Inicial</a></li>
            
          </ul>
        </nav>
      </div>
      <p class="footer-copy font-2-m cor-6">Codominio Reserva © Todos os direitos reservados.</p>
    </div>
  </footer>

  <!-- SCRIPT -->
  

  <script>
  const form = document.getElementById("demandasForm");
  const botao = form.querySelector("button[type='submit']");

  form.addEventListener("submit", async function (e) {
    e.preventDefault();

    botao.disabled = true;
    botao.textContent = "Enviando...";

    const dados = {
      id: crypto.randomUUID(),
      nome_solicitante: document.getElementById("nome").value.trim(),
      numero_casa: document.getElementById("numero_casa").value.trim(),
      whatsapp: document.getElementById("whatsapp").value.trim(),
      email: document.getElementById("email").value.trim(),
      tipo_pessoa: document.getElementById("tipo_pessoa").value,
      tipo_solicitacao: document.getElementById("tipo_solicitacao").value,
      descricao: document.getElementById("descricao").value.trim(),
      created_at: new Date().toISOString()
    };

    try {
      const response = await fetch("/.netlify/functions/insert-demand", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(dados)
      });

      if (response.ok) {
        alert("✅ Solicitação enviada com sucesso!");
        form.reset();
      } else {
        const erro = await response.text();
        console.error("Erro:", erro);
        alert("❌ Erro ao enviar. Veja o console.");
      }
    } catch (erro) {
      console.error("Erro inesperado:", erro);
      alert("❌ Erro de conexão com o servidor.");
    } finally {
      botao.disabled = false;
      botao.textContent = "Enviar Solicitação";
    }
  });
</script>


</body>
</html>
